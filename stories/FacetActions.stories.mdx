import { Meta, Story, Preview, Props } from '@storybook/addon-docs/blocks';

import UnbxdSearchWrapper from '../src/UnbxdSearchWrapper';
import FacetActions from '../src/modules/facetActions';
import TextFacets from '../src/modules/textFacets';
import Products from '../src/modules/products';
import SearchBox from '../src/modules/searchBox';
import {
    ApplyFilter as ApplyFilterComponent,
    ClearFilter as ClearFilterComponent,
    onApply,
    onClear
} from '../demo/src/components/FacetApplyClear.js';
import { siteKey, apiKey, attributesMap, defaultSearch } from './config';

<Meta title="FacetActions" component={FacetActions} />

# FacetActions

### module to display facet actions like apply and clear.

##### Note:

-   When `FacetActions` module is included, `RangeFacets` and `TextFacets` will be applied only on actions `Apply` and `Clear`.

```jsx
<FacetActions />
```

<Preview>
    <Story name="default">
        <UnbxdSearchWrapper siteKey={siteKey} apiKey={apiKey}>
            <FacetActions />
            <TextFacets />
            <Products attributesMap={attributesMap} />
            <div className="hidden">
                <SearchBox defaultSearch={defaultSearch} />
            </div>
        </UnbxdSearchWrapper>
    </Story>
</Preview>

---

### showApplyFilter

Apply filter is enabled by default. It can be disabled by passing `showApplyFilter` as `false`.

```jsx
<FacetActions showApplyFilter={false} />
```

<Preview>
    <Story name="with showApplyFilter">
        <UnbxdSearchWrapper siteKey={siteKey} apiKey={apiKey}>
            <FacetActions showApplyFilter={false} />
            <TextFacets />
            <Products attributesMap={attributesMap} />
            <div className="hidden">
                <SearchBox defaultSearch={defaultSearch} />
            </div>
        </UnbxdSearchWrapper>
    </Story>
</Preview>

---

### showClearFilter

Clear filter is enabled by default. It can be disabled by passing `showClearFilter` as `false`.

```jsx
<FacetActions showClearFilter={false} />
```

<Preview>
    <Story name="with showClearFilter">
        <UnbxdSearchWrapper siteKey={siteKey} apiKey={apiKey}>
            <FacetActions showClearFilter={false} />
            <TextFacets />
            <Products attributesMap={attributesMap} />
            <div className="hidden">
                <SearchBox defaultSearch={defaultSearch} />
            </div>
        </UnbxdSearchWrapper>
    </Story>
</Preview>

---

### applyFilterComponent

The default Apply Filter component can be overridden by passing a custom component instance.

```jsx
const ApplyFilterComponent = ({ onApplyFilter }) => (
    <button className="-apply" onClick={onApplyFilter}>
        Apply
    </button>
);
```

The component instance will receive the following parameters

#### applyFilterComponent props

| Name          | Type | Description          |
| ------------- | ---- | -------------------- |
| onApplyFilter | func | handle facets apply. |

```jsx
<FacetActions applyFilterComponent={<ApplyFilterComponent />} />
```

<Preview>
    <Story name="with applyFilterComponent">
        <UnbxdSearchWrapper siteKey={siteKey} apiKey={apiKey}>
            <FacetActions applyFilterComponent={<ApplyFilterComponent />} />
            <TextFacets />
            <Products attributesMap={attributesMap} />
            <div className="hidden">
                <SearchBox defaultSearch={defaultSearch} />
            </div>
        </UnbxdSearchWrapper>
    </Story>
</Preview>

---

### clearFilterComponent

The default Clear Filter component can be overridden by passing a custom component instance.

```jsx
const ClearFilterComponent = ({ onClearFilter }) => (
    <button className="-clear" onClick={onClearFilter}>
        Clear
    </button>
);
```

The component instance will receive the following parameters

#### clearFilterComponent props

| Name          | Type | Description          |
| ------------- | ---- | -------------------- |
| onClearFilter | func | handle facets clear. |

```jsx
<FacetActions clearFilterComponent={<ClearFilterComponent />} />
```

<Preview>
    <Story name="with clearFilterComponent">
        <UnbxdSearchWrapper siteKey={siteKey} apiKey={apiKey}>
            <FacetActions clearFilterComponent={<ClearFilterComponent />} />
            <TextFacets />
            <Products attributesMap={attributesMap} />
            <div className="hidden">
                <SearchBox defaultSearch={defaultSearch} />
            </div>
        </UnbxdSearchWrapper>
    </Story>
</Preview>

---

### onApply

The callback on the click of apply filter. Return `true` to proceed with the apply or return `false` to abort.

```jsx
const onApply = (selectedTextFacets, selectedRangeFacets) => {
    console.log('Facets apply :', selectedTextFacets, selectedRangeFacets);
    return true;
};
```

The callback will receive the following parameters

#### onApply parameters

| Name                | Type   | Description         |
| ------------------- | ------ | ------------------- |
| selectedTextFacets  | object | text facet values.  |
| selectedRangeFacets | object | range facet values. |

```jsx
<FacetActions onApply={onApply} />
```

<Preview>
    <Story name="with onApply">
        <UnbxdSearchWrapper siteKey={siteKey} apiKey={apiKey}>
            <FacetActions onApply={onApply} />
            <TextFacets />
            <Products attributesMap={attributesMap} />
            <div className="hidden">
                <SearchBox defaultSearch={defaultSearch} />
            </div>
        </UnbxdSearchWrapper>
    </Story>
</Preview>

---

### onClear

The callback on the click of clear filter. Return `true` to proceed with the clear or return `false` to abort.

```jsx
const onClear = () => {
    console.log('Facets clear :');
    return true;
};
```

The callback will receive the following parameters

#### onClear parameters

| Name                | Type   | Description         |
| ------------------- | ------ | ------------------- |
| selectedTextFacets  | object | text facet values.  |
| selectedRangeFacets | object | range facet values. |

```jsx
<FacetActions onClear={onClear} />
```

<Preview>
    <Story name="with onClear">
        <UnbxdSearchWrapper siteKey={siteKey} apiKey={apiKey}>
            <FacetActions onClear={onClear} />
            <TextFacets />
            <Products attributesMap={attributesMap} />
            <div className="hidden">
                <SearchBox defaultSearch={defaultSearch} />
            </div>
        </UnbxdSearchWrapper>
    </Story>
</Preview>

---

### Render props

-   This approach gives the total control of the module to the user.
-   The anonymous function will receive all the data and methods needed to build and manage the module.

#### Render prop parameters

| Name              | Type   | Description                        |
| ----------------- | ------ | ---------------------------------- |
| showApplyFilter   | bool   | display apply filter.              |
| showClearFilter   | bool   | display clear filter.              |
| onApplyFilter     | func   | handle apply facets click.         |
| onClearFilter     | func   | handle clear facets click.         |
| manageTextFacets  | func   | manage text facets.                |
| manageRangeFacets | func   | manage range facets.               |
| noOfPages         | number | number of pages for current query. |

<Preview>
    <Story name="with render props">
        <UnbxdSearchWrapper siteKey={siteKey} apiKey={apiKey}>
            <FacetActions>
                {({
                    showApplyFilter,
                    showClearFilter,
                    onApplyFilter,
                    onClearFilter,
                    noOfPages
                }) => {
                    return <div>render FacetActions</div>;
                }}
            </FacetActions>
            <TextFacets />
            <Products attributesMap={attributesMap} />
            <div className="hidden">
                <SearchBox defaultSearch={defaultSearch} />
            </div>
        </UnbxdSearchWrapper>
    </Story>
</Preview>

---

# Props

<Props of={FacetActions} />
